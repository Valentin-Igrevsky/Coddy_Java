```java
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        Game game = new Game();
        game.start();
    }
}

class Game {
    private final Scanner scanner = new Scanner(System.in);
    private final Player player1;
    private final Player player2;

    Game() {
        System.out.println("Добро пожаловать в Морской бой!");

        System.out.print("Имя игрока 1: ");
        String n1 = scanner.nextLine();
        System.out.print("Имя игрока 2: ");
        String n2 = scanner.nextLine();

        Board board1 = new Board();
        Board board2 = new Board();

        player1 = new Player(n1.isEmpty() ? "Игрок1" : n1, board1);
        player2 = new Player(n2.isEmpty() ? "Игрок2" : n2, board2);
    }

    void start() {
        System.out.println(" --- Расстановка кораблей --- ");
        setupPlayer(player1);
        pressEnterToContinue();
        setupPlayer(player2);
        pressEnterToContinue();

        Player current = player1;
        Player opponent = player2;
        while (true) {
            clearScreen();
            System.out.println("Ход: " + current.name);
            System.out.println();

            // Показываем поле противника
            opponent.getBoard().printBoard(true);
            System.out.println();

            // Показываем своё поле
            current.getBoard().printBoard(false);
            System.out.println();

            boolean validShot = false;
            while (!validShot) {
                System.out.print(current.name + ", введите цель (например A 5): ");
                String line = scanner.nextLine().trim().toUpperCase();
                String[] parts = line.split(" ");
                if (parts.length != 2) {
                    System.out.println("Неверный ввод. Укажите координату и направление, например Б 2 DOWN.");
                    continue;
                }
                Coordinate c = Coordinate.fromString(parts[0], parts[1]);
                if (c == null || !Board.inBounds(c)) {
                    System.out.println("Неверная координата. Попробуйте снова.");
                    continue;
                }
                ShotResult res = opponent.getBoard().hit_cell(c);
                switch (res) {
                    case MISS:
                        System.out.println("Мимо!");
                        validShot = true;
                        break;
                    case HIT:
                        System.out.println("Попадание!");
                        System.out.println(current.name + "продолжает ходить!");
                        break;
                    case SUNK:
                        System.out.println("Корабль потоплен!");
                        System.out.println(current.name + "продолжает ходить!");
                        break;
                    case ALREADY:
                        System.out.println("Эта клетка уже была обстреляна. Выберите другую.");
                        break;
                }
            }

            // смена игроков
            Player tmp = current;
            current = opponent;
            opponent = tmp;
            pressEnterToContinue();
        }
    }

    private void setupPlayer(Player player) {
        clearScreen();
        System.out.println(player.name + ", расставьте свои корабли.");
        System.out.println("Доступные корабли:");
        for (int i = 0; i < Board.SHIP_LENGTHS.length; i++) {
            System.out.printf("%d корабль(я) длины %d\n", i+1, Board.SHIP_LENGTHS[i]);
        }
        manualPlacement(player);
        System.out.println("Готово. Вот ваше поле:");
        player.getBoard().printBoard(false);
    }

    private void manualPlacement(Player player) {
        Board board = player.getBoard();
        for (int i = 0; i < Board.SHIP_LENGTHS.length; i++) {
            for (int j = 0; j < i+1; j++) {
                int size = Board.SHIP_LENGTHS[i];
                boolean placed = false;
                while (!placed) {
                    board.printBoard(false);
                    System.out.printf("Разместите %d корабль размера %d. Формат: Координата Расположение (например Б 2 DOWN) ", j+1, size);
                    System.out.print("Введите: ");
                    String line = scanner.nextLine().trim().toUpperCase();
                    String[] parts = line.split(" ");
                    if (parts.length != 3) {
                        System.out.println("Неверный ввод. Укажите координату и направление, например Б 2 DOWN.");
                        continue;
                    }
                    Coordinate c = Coordinate.fromString(parts[0], parts[1]);
                    if (c == null || !Board.inBounds(c)) {
                        System.out.println("Неверная координата. Попробуйте снова.");
                        continue;
                    }

                    String dir = parts[2];
                    boolean isOkayDirection = switch (dir) {
                        case "DOWN" -> true;
                        case "RIGHT" -> true;
                        default -> false;
                    };

                    if (!isOkayDirection) {
                        System.out.println("Неверное направление. Попробуйте снова.");
                        continue;
                    }
                    boolean ok = board.set_ship(c, size, dir);

                    if (!ok) System.out.println("Невозможно разместить корабль в этом месте. Попробуйте снова.");
                    else placed = true;
                }
            }

        }
    }

    private void pressEnterToContinue() {
        System.out.println("Нажмите Enter, чтобы продолжить...");
        scanner.nextLine();
    }

    private void clearScreen() {
        for (int i = 0; i < 40; i++) System.out.println();
    }
}

class Player {
    public final String name;
    private final Board board;

    Player(String name, Board board) {
        this.name = name;
        this.board = board;
    }

    public Board getBoard() {
        return board;
    }
}

class Board {
    public static final int SIZE = 10;
    public static final int[] SHIP_LENGTHS = {4, 3, 2 ,1};
    private final Cell[][] board = new Cell[SIZE][SIZE];

    public Board() {
        for (int i = 0; i < SIZE; i++) {
            for (int j = 0; j < SIZE; j++) {
                this.board[i][j] = new Cell();
            }
        }
    }

    public static boolean inBounds(Coordinate coordinate) {
        if (coordinate.x < 0) {
            return false;
        } else if (coordinate.y < 0) {
            return false;
        } else if (coordinate.x >= SIZE){
            return false;
        } else if (coordinate.y >= SIZE) {
            return false;
        } else {
            return true;
        }
    }

    private boolean canPlaceShip(Coordinate start, Coordinate end) {
        int min_x = start.x - 1;
        int min_y = start.y - 1;
        int max_x = end.x + 1;
        int max_y = end.y + 1;

        if (min_x < 0) min_x = 0;
        if (min_y < 0) min_y = 0;
        if (max_x >= SIZE) max_x = SIZE - 1;
        if (max_y >= SIZE) max_y = SIZE - 1;

        for (int y = min_y; y <= max_y; y++) {
            for (int x = min_x; x <= max_x; x++) {
                if (this.board[y][x].isShip) {
                    return false;
                }
            }
        }
        return true;
    }

    public boolean set_ship(Coordinate coordinate, int ship_length, String direction) {
        Coordinate[] coordinates = new Coordinate[ship_length];

        int x = coordinate.x;
        int y = coordinate.y;

        switch (direction) {
            case "DOWN":
                for (int i = 0; i < ship_length; i++) {
                    Coordinate new_coordinate = new Coordinate(x, y + i);
                    coordinates[i] = new_coordinate;
                }
                break;
            case "RIGHT":
                for (int i = 0; i < ship_length; i++) {
                    Coordinate new_coordinate = new Coordinate(x + i, y);
                    coordinates[i] = new_coordinate;
                }
                break;
            // Здесь можно добавить варианты left (влево) и up (вверх)
        }

        for (int i = 0; i < ship_length; i++) {
            boolean inBounds = inBounds(coordinates[i]);
            if (!inBounds) {
                return false;
            }
        }

        boolean canPlaceShip = canPlaceShip(coordinates[0], coordinates[ship_length - 1]);
        if (!canPlaceShip) {
            return false;
        }

        Ship new_ship = new Ship(ship_length);
        new_ship.set_coordinates(coordinates);

        for (int i = 0; i < ship_length; i++) {
            board[coordinates[i].y][coordinates[i].x].isShip = true;
            board[coordinates[i].y][coordinates[i].x].ship = new_ship;
        }

        return true;
    }

    public ShotResult hit_cell(Coordinate coordinate) {
        int x = coordinate.x;
        int y = coordinate.y;

        Cell cell = this.board[y][x];
        if (cell.isOpened) {
            return ShotResult.ALREADY;
        }
        cell.isOpened = true;
        if (cell.isShip) {
            return cell.ship.add_hit(new Coordinate(x, y));
        } else {
            return ShotResult.MISS;
        }
    }

    public void printBoard(boolean isForEnemy) {
        if (isForEnemy) {
            System.out.println("Поле врага:");
        } else {
            System.out.println("Собственное поле:");
        }
        System.out.println("   А Б В Г Д Е Ж З И К");
        for (int y = 0; y < SIZE; y++) {
            System.out.printf("%2d ", y + 1);
            for (int x = 0; x < SIZE; x++) {
                Cell cell = board[y][x];
                String ch;
                if (cell.isShip) {
                    ch = cell.ship.print_ship_part(new Coordinate(x, y), isForEnemy);
                } else if (cell.isOpened) {
                    ch = "o";
                } else {
                    ch = ".";
                }
                System.out.print(ch + " ");
            }
            System.out.println();
        }
    }
}

class Cell {
    public boolean isOpened;
    public boolean isShip;
    public Ship ship;

    public Cell() {
        this.isOpened = false;
        this.isShip = false;
        this.ship = null;
    }
}

class Ship {
    private final int length;
    private Coordinate[] coordinates;
    private Coordinate[] hits;
    private int hit_count;

    public Ship(int length) {
        this.length = length;
        this.coordinates = new Coordinate[length];
        this.hits = new Coordinate[length];
        this.hit_count = 0;

        for (int i = 0; i < length; i++) {
            this.coordinates[i] = null;
            this.hits[i] = null;
        }
    }

    public void set_coordinates(Coordinate[] coordinates) {
        this.coordinates = coordinates;
    }

    public ShotResult add_hit(Coordinate hit) {
        for (int i = 0; i < this.length; i++) {
            if (hit.equals(this.coordinates[i])) {
                this.hits[i] = hit;
                this.hit_count++;
            }
        }
        return this.isDead();
    }

    private ShotResult isDead() {
        if (this.hit_count == this.length) {
            return ShotResult.SUNK;
        } else {
            return ShotResult.HIT;
        }
    }

    String print_ship_part(Coordinate coordinate, boolean isForEnemy) {
        for (int i = 0; i < this.length; i++) {
            if (coordinate.equals(this.hits[i])) {
                return "X";
            }
        }
        if (isForEnemy) {
            return ".";
        } else {
            return "S";
        }
    }
}

class Coordinate {
    public int x;
    public int y;

    public Coordinate(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public boolean equals(Coordinate other) {
        if (other == null) {
            return false;
        }
        return this.x == other.x && this.y == other.y;
    }

    public static Coordinate fromString(String letter, String num) {
        if (letter == null) return null;
        if (num == null) return null;

        int x = switch (letter) {
            case "А" -> 0;
            case "Б" -> 1;
            case "В" -> 2;
            case "Г" -> 3;
            case "Д" -> 4;
            case "Е" -> 5;
            case "Ж" -> 6;
            case "З" -> 7;
            case "И" -> 8;
            case "К" -> 9;
            default -> -1;
        };

        if (x < 0) return null;

        int y = Integer.parseInt(num)-1;

        if (y < 0 || y > 9) return null;

        return new Coordinate(x, y);
    }
}

enum ShotResult {MISS, HIT, SUNK, ALREADY}
```